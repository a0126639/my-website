<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>測試：固定 X，Y 可動</title>
  <style>
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      font-family: Arial, sans-serif;
      display:grid;
      grid-template-columns:200px 1fr 250px;
      height:100vh;
      overflow:hidden;
    }
    nav{background:#f0f0f0;padding:12px;border-right:1px solid #ccc}
    aside{background:#fafafa;padding:12px;border-left:1px solid #ccc;overflow:auto}
    main{position:relative;overflow:hidden}
    /* 這個是我們要移動的 wrapper（把 transform 套在這裡） */
    .movable {
      position:absolute;
      left:0;
      top:0;
      width:4000px;   /* 讓內容足夠寬 */
      height:4000px;  /* 讓內容足夠高 */
      transform-origin:0 0;
      will-change:transform;
    }
    .movable iframe {
      display:block;
      width:100%;
      height:100%;
      border:0;
    }
    /* 手機：取消裁切，讓 iframe 正常顯示 */
    @media (max-width:768px){
      body{grid-template-columns:1fr;grid-template-rows:auto 1fr auto;height:auto;overflow:auto}
      nav{border-bottom:1px solid #ccc}
      aside{border-top:1px solid #ccc}
      main{height:auto;overflow:visible}
      .movable{position:relative;width:100%;height:80vh;transform:none!important}
      .movable iframe{width:100%;height:100%}
    }
    /* 測試按鈕（可刪） */
    .tester{
      position:fixed; right:12px; top:12px; z-index:9999;
      background:rgba(0,0,0,0.6); color:#fff; padding:8px; border-radius:6px; font-size:13px;
    }
    .tester button{margin:4px; padding:6px 8px}
  </style>
</head>
<body>
  <nav>
    <h3>導航</h3>
    <a href="#">link</a>
  </nav>

  <main>
    <!-- 我們把 iframe 放在 .movable 裡面，並移動 .movable -->
    <div class="movable" id="movable">
      <iframe id="theIframe" src="https://www.jljh.com.tw/usedcust/index.php?t=1&npg=" title="測試"></iframe>
    </div>
  </main>

  <aside>
    <h3>廣告</h3>
    <div>ad</div>
  </aside>

  <!-- 測試用按鈕：左/右/套用 tx（上線後可移除） -->
  <div class="tester" id="tester">
    <div>測試 X (固定區間 -2700 ~ -3500)</div>
    <button id="btnLeft">設 -2700</button>
    <button id="btnMid">設 -3100</button>
    <button id="btnRight">設 -3500</button>
  </div>

  <script>
    // ---------- 參數（你要的設定） ----------
    const X_MIN = -3500; // 最左（數值更負）
    const X_MAX = -2700; // 最右（數值較小）
    let currentX = -3100; // 預設顯示位置（介於 X_MAX 與 X_MIN）
    let currentY = -420;  // Y 固定

    const movable = document.getElementById('movable');
    const iframe = document.getElementById('theIframe');

    function applyTransform() {
      movable.style.transform = `translate(${currentX}px, ${currentY}px)`;
      console.log('applied transform', currentX, currentY, getComputedStyle(movable).transform);
    }

    // 測試按鈕事件
    document.getElementById('btnLeft').addEventListener('click', () => { currentX = X_MAX; applyTransform(); });
    document.getElementById('btnMid').addEventListener('click', () => { currentX = Math.round((X_MIN+X_MAX)/2); applyTransform(); });
    document.getElementById('btnRight').addEventListener('click', () => { currentX = X_MIN; applyTransform(); });

    // 允許 Y 軸 滾輪 / 觸控控制（你要的 Y 可動）
    let isDragging = false, startY = 0, startTy = currentY;
    movable.addEventListener('mousedown', (e)=>{ isDragging=true; startY=e.clientY; startTy=currentY; movable.style.cursor='grabbing'; });
    window.addEventListener('mousemove',(e)=>{ if(!isDragging) return; const d = e.clientY - startY; currentY = startTy + d; applyTransform(); });
    window.addEventListener('mouseup', ()=>{ isDragging=false; movable.style.cursor='grab'; });

    // 觸控
    let tStartY=0, tStartTy=currentY;
    movable.addEventListener('touchstart', (e)=>{ tStartY = e.touches[0].clientY; tStartTy = currentY; }, {passive:true});
    movable.addEventListener('touchmove', (e)=>{ const d = e.touches[0].clientY - tStartY; currentY = tStartTy + d; applyTransform(); }, {passive:true});

    // 初始化
    applyTransform();

    // ---------- 快速 debug 指令（在 Console 可執行） ----------
    // document.getElementById('movable').style.transform = 'translate(-3200px, -420px)';
    // console.log(getComputedStyle(document.getElementById('movable')).transform);

    // 當 iframe 載入或被阻擋的提示（會在 console 顯示）
    let loaded=false;
    iframe.addEventListener('load', ()=>{ loaded=true; console.log('iframe loaded'); });
    setTimeout(()=>{ if(!loaded) console.warn('iframe 可能被阻擋 (X-Frame-Options/CSP) 或載入緩慢，請查看 Network/Console'); }, 3000);
  </script>
</body>
</html>
