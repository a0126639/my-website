<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>蚤激安寄賣小舖 — 調整工具</title>
  <style>
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      font-family: Arial, sans-serif;
      display:grid;
      grid-template-columns:200px 1fr 250px;
      height:100vh;
      overflow:hidden;
    }
    nav{background:#f0f0f0;padding:12px;border-right:1px solid #ddd}
    nav a{display:block;margin:8px 0;color:#333;text-decoration:none}
    aside{background:#fafafa;padding:12px;border-left:1px solid #ddd;overflow:auto}
    .ad-box{background:#e8e8e8;padding:10px;margin-bottom:10px;text-align:center}

    main{position:relative; overflow:hidden; background:#fff}

    /* 裁切容器與 wrapper */
    .crop{position:absolute; left:0; top:0; width:100%; height:100%; overflow:hidden;}
    .wrapper{
      position:absolute; left:0; top:0;
      width:4000px; height:4000px;
      transform-origin:0 0;
      will-change:transform;
    }
    .wrapper iframe{display:block; width:100%; height:100%; border:0;}

    /* 參考線 */
    .guide {
      position:absolute; top:0; bottom:0; width:4px;
      pointer-events:none;
      z-index: 9998;
    }
    .guide.left { left: 150px; background: rgba(0,200,0,0.25); }   /* 預設顯示位置，會可拖 */
    .guide.right{ right: 160px; background: rgba(200,0,0,0.25); }

    /* 控制面板（右上角） */
    .panel {
      position:fixed; right:12px; top:12px; z-index:9999;
      background: rgba(255,255,255,0.95); border:1px solid #ddd;
      padding:10px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.08);
      font-size:13px;
      width:260px;
    }
    .panel .row{display:flex;gap:6px;margin-top:8px;align-items:center}
    .panel button{padding:6px 8px;border-radius:4px;border:1px solid #ccc;background:#f7f7f7;cursor:pointer}
    .panel button.small{padding:4px 6px;font-size:12px}
    .panel .value{font-weight:600; min-width:90px; text-align:right}

    /* 手機：取消裁切，直接顯示完整頁面 */
    @media (max-width:768px){
      body{grid-template-columns:1fr;grid-template-rows:auto 1fr auto;height:auto;overflow:auto}
      nav{border-bottom:1px solid #ddd}
      aside{border-top:1px solid #ddd}
      main{height:auto}
      .crop{position:relative;height:70vh}
      .wrapper{position:relative;width:100%;height:100%;transform:none !important}
      .wrapper iframe{width:100%;height:100%}
      /* 隱藏面板以避免遮擋（若你需要手機調整，可移除此段） */
      .panel{display:none}
      .guide{display:none}
    }

    /* 小提示文字 */
    .hint{font-size:12px;color:#666;margin-top:6px}
  </style>
</head>
<body>
  <nav>
    <h3>網站導覽</h3>
    <a href="https://www.google.com" target="_blank">Google</a>
    <a href="https://www.youtube.com" target="_blank">YouTube</a>
    <a href="https://www.jljh.com.tw/" target="_blank">公司官網</a>
  </nav>

  <main>
    <div class="crop" id="crop">
      <div class="wrapper" id="wrapper">
        <iframe id="theIframe"
          src="https://www.jljh.com.tw/usedcust/index.php?mkind=1&list_bno=BD&list_area=A&cate_no=&mnotea=&bagok=%E6%90%9C%E5%B0%8B"
          title="公司商品列表"></iframe>
      </div>
    </div>

    <!-- 參考線（可視化） -->
    <div class="guide left" id="guideLeft"></div>
    <div class="guide right" id="guideRight"></div>
  </main>

  <aside>
    <h3>廣告區</h3>
    <div class="ad-box">廣告 1</div>
    <div class="ad-box">廣告 2</div>
  </aside>

  <!-- 控制面板 -->
  <div class="panel" id="panel">
    <div><strong>微調工具（桌機用）</strong></div>

    <div class="hint">使用 ← → 鍵微調 X；↑ ↓ 鍵微調 Y。或用下面按鈕精調。</div>

    <div class="row">
      <div style="flex:1">
        TX: <span class="value" id="txVal">-3100</span>
      </div>
      <div style="flex:1">
        TY: <span class="value" id="tyVal">-420</span>
      </div>
    </div>

    <div class="row">
      <button id="left1" class="small">◀1</button>
      <button id="left5" class="small">◀5</button>
      <button id="left10" class="small">◀10</button>
      <button id="right1" class="small">1▶</button>
      <button id="right5" class="small">5▶</button>
      <button id="right10" class="small">10▶</button>
    </div>

    <div class="row">
      <button id="up1" class="small">▲1</button>
      <button id="up5" class="small">▲5</button>
      <button id="down1" class="small">▼1</button>
      <button id="down5" class="small">▼5</button>
      <button id="save" style="margin-left:auto;background:#007bff;color:#fff">Save</button>
    </div>

    <div class="hint">左線 (綠) = 左邊開始顯示；右線 (紅) = 右邊完全顯示</div>
  </div>

  <script>
    // ---- 可修改起註值（初始值） ----
    let tx = -3100; // 初始 X（可用面板或鍵盤調整）
    let ty = -420;  // 初始 Y

    // 建議你最終的 X 範圍可以是 -2700 到 -3500（依內容寬度調整）
    const TX_MIN = -3500; // 最左（更負）
    const TX_MAX = -2700; // 最右（較小負）

    // Y 範圍（可自行調）
    const TY_MIN = -2000;
    const TY_MAX = 0;

    // 元素
    const wrapper = document.getElementById('wrapper');
    const txVal = document.getElementById('txVal');
    const tyVal = document.getElementById('tyVal');
    const guideLeft = document.getElementById('guideLeft');
    const guideRight = document.getElementById('guideRight');

    // 顯示/套用 transform
    function apply() {
      wrapper.style.transform = `translate(${tx}px, ${ty}px)`;
      txVal.textContent = tx;
      tyVal.textContent = ty;
    }

    // 小按鈕功能
    function moveX(delta) {
      tx = Math.min(Math.max(tx + delta, TX_MIN), TX_MAX);
      apply();
    }
    function moveY(delta) {
      ty = Math.min(Math.max(ty + delta, TY_MIN), TY_MAX);
      apply();
    }

    // 綁按鈕
    document.getElementById('left1').onclick = () => moveX(-1);
    document.getElementById('left5').onclick = () => moveX(-5);
    document.getElementById('left10').onclick = () => moveX(-10);
    document.getElementById('right1').onclick = () => moveX(1);
    document.getElementById('right5').onclick = () => moveX(5);
    document.getElementById('right10').onclick = () => moveX(10);

    document.getElementById('up1').onclick = () => moveY(-1);
    document.getElementById('up5').onclick = () => moveY(-5);
    document.getElementById('down1').onclick = () => moveY(1);
    document.getElementById('down5').onclick = () => moveY(5);

    // Save：會彈出目前 tx/ty，並複製到剪貼簿（方便你貼回程式）
    document.getElementById('save').onclick = async () => {
      const txt = `tx=${tx}, ty=${ty}`;
      try {
        await navigator.clipboard.writeText(txt);
        alert('已複製到剪貼簿：\n' + txt + '\n\n請把這組數值提供給我或寫回 index.html');
      } catch (e) {
        alert('數值：\n' + txt + '\n\n（無法自動複製，請手動複製）');
      }
    };

    // 鍵盤支援（← → ↑ ↓）
    window.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') { moveX(-1); e.preventDefault(); }
      if (e.key === 'ArrowRight'){ moveX(1); e.preventDefault(); }
      if (e.key === 'ArrowUp')   { moveY(-1); e.preventDefault(); }
      if (e.key === 'ArrowDown') { moveY(1); e.preventDefault(); }
      // 按住 shift 可加速
      if (e.shiftKey) {
        if (e.key === 'ArrowLeft') { moveX(-10); }
        if (e.key === 'ArrowRight'){ moveX(10); }
      }
    });

    // 可拖動參考線（方便你微調顯示位置的可視邊界）
    function makeGuideDraggable(el, side) {
      let dragging = false, startX = 0, startLeft = 0;
      el.addEventListener('mousedown', (ev) => {
        dragging = true; startX = ev.clientX;
        startLeft = el === guideLeft ? el.offsetLeft : (window.innerWidth - el.offsetLeft - el.offsetWidth);
        el.style.pointerEvents = 'auto';
      });
      window.addEventListener('mousemove', (ev) => {
        if (!dragging) return;
        const dx = ev.clientX - startX;
        if (side === 'left') {
          let newLeft = startLeft + dx;
          if (newLeft < 0) newLeft = 0;
          el.style.left = newLeft + 'px';
        } else {
          let newRight = startLeft - dx;
          if (newRight < 0) newRight = 0;
          el.style.right = newRight + 'px';
        }
      });
      window.addEventListener('mouseup', ()=>{ dragging = false; });
    }
    makeGuideDraggable(guideLeft, 'left');
    makeGuideDraggable(guideRight, 'right');

    // 初始化位置（若你有預估值，可改這兩個）
    tx = Math.round((TX_MIN + TX_MAX) / 2);
    ty = -420;
    apply();

    // iframe load check（若顯示空白請打開 DevTools -> Console 看是否有 X-Frame-Options）
    const iframe = document.getElementById('theIframe');
    let loaded = false;
    iframe.addEventListener('load', ()=>{ loaded = true; console.log('iframe loaded'); });
    setTimeout(()=>{ if(!loaded) console.warn('iframe 3s 尚未載入（若空白請檢查 Console 是否有 X-Frame-Options/CSP）'); }, 3000);
  </script>
</body>
</html>
